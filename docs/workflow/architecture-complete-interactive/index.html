<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Architecture ComplÃ¨te - Diagramme Interactif</title>
    <link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.2/joint.min.css'>
    <link rel="stylesheet" href="./style.css">
</head>
<body>
    <!-- Pre-Load Fonts -->
    <div class="font-loader" style="visibility: hidden">
        <div style="font-family: PPFraktionSans, sans-serif; font-weight: 300; font-style: normal;">Regular</div>
        <div style="font-family: PPFraktionSans, sans-serif; font-weight: 300; font-style: italic;">Regular Italic</div>
        <div style="font-family: PPFraktionSans, sans-serif; font-weight: 600; font-style: normal;">Bold</div>
    </div>

    <!-- Main Canvas -->
    <div id="canvas"></div>

    <!-- Theme Switch -->
    <div class="theme-switch" title="Basculer entre mode clair et sombre">
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="none" stroke="#dde6ed" stroke-linecap="round" stroke-linejoin="round" class="light-icon">
            <path d="M12 18.5C15.5899 18.5 18.5 15.5899 18.5 12C18.5 8.41015 15.5899 5.5 12 5.5C8.41015 5.5 5.5 8.41015 5.5 12C5.5 15.5899 8.41015 18.5 12 18.5Z" stroke-width="1.5" />
            <path d="M19.14 19.14L19.01 19.01M19.01 4.99L19.14 4.86L19.01 4.99ZM4.86 19.14L4.99 19.01L4.86 19.14ZM12 2.08V2V2.08ZM12 22V21.92V22ZM2.08 12H2H2.08ZM22 12H21.92H22ZM4.99 4.99L4.86 4.86L4.99 4.99Z" stroke-width="2" />
        </svg>
        <svg xmlns="http://www.w3.org/2000/svg" width="20px" height="20px" viewBox="0 0 24 24" fill="#131e29" class="dark-icon">
            <path d="M12.0557 3.59974C12.2752 3.2813 12.2913 2.86484 12.0972 2.53033C11.9031 2.19582 11.5335 2.00324 11.1481 2.03579C6.02351 2.46868 2 6.76392 2 12C2 17.5228 6.47715 22 12 22C17.236 22 21.5313 17.9764 21.9642 12.8518C21.9967 12.4664 21.8041 12.0968 21.4696 11.9027C21.1351 11.7086 20.7187 11.7248 20.4002 11.9443C19.4341 12.6102 18.2641 13 17 13C13.6863 13 11 10.3137 11 6.99996C11 5.73589 11.3898 4.56587 12.0557 3.59974Z" />
        </svg>
        <div class="switch"></div>
    </div>

    <!-- Toggle Buttons -->
    <div class="panel-toggles">
        <button id="toggle-controls" class="toggle-btn" title="Afficher/Masquer les contrÃ´les">
            ğŸ®
        </button>
        <button id="toggle-info" class="toggle-btn" title="Afficher/Masquer les instructions">
            ğŸ“‹
        </button>
    </div>

    <!-- Controls Panel -->
    <div class="controls-panel" id="controls-panel">
        <div class="panel-header">
            <h3>ğŸ® ContrÃ´les Interactifs</h3>
            <button class="close-btn" onclick="hideControlsPanel()" title="Fermer">Ã—</button>
        </div>
        <div class="control-buttons">
            <button onclick="debugConnections()" class="debug-btn">ğŸ” Debug Connexions</button>
            <button onclick="optimizeAllConnections()" class="optimize-btn">ğŸ”§ Optimiser Connexions</button>
            <button onclick="selectNode('Interface Utilisateur')" class="select-btn">ğŸ“± SÃ©lectionner Frontend</button>
            <button onclick="selectNode('WorkflowService')" class="select-btn">âš™ï¸ SÃ©lectionner Service</button>
            <button onclick="selectNode('Flask')" class="select-btn">ğŸŒ SÃ©lectionner Flask</button>
            <button onclick="clearSelection()" class="clear-btn">âŒ Effacer SÃ©lection</button>
            <button onclick="resetDiagram()" class="reset-btn">ğŸ”„ RÃ©initialiser</button>
        </div>
        <div class="status" id="status">
            PrÃªt - Explorez l'architecture du systÃ¨me en cliquant sur les composants.
        </div>
    </div>

    <!-- Info Panel -->
    <div class="info-panel" id="info-panel">
        <div class="panel-header">
            <h4>ğŸ“‹ Guide d'Architecture</h4>
            <button class="close-btn" onclick="hideInfoPanel()" title="Fermer">Ã—</button>
        </div>
        <ul>
            <li><strong>SÃ©lection:</strong> Cliquez sur un composant pour le sÃ©lectionner</li>
            <li><strong>DÃ©placement:</strong> Glissez les composants sÃ©lectionnÃ©s</li>
            <li><strong>Connexions:</strong> Les liens se re-routent automatiquement</li>
            <li><strong>ThÃ¨me:</strong> Utilisez le commutateur en haut Ã  droite</li>
            <li><strong>Couches:</strong>
                <ul>
                    <li><span class="color-indicator frontend"></span> Frontend (Bleu)</li>
                    <li><span class="color-indicator flask"></span> Flask (Orange)</li>
                    <li><span class="color-indicator service"></span> Services (Violet)</li>
                    <li><span class="color-indicator config"></span> Configuration (Vert)</li>
                    <li><span class="color-indicator processing"></span> Processing (Jaune)</li>
                    <li><span class="color-indicator data"></span> DonnÃ©es (Rose)</li>
                    <li><span class="color-indicator external"></span> Externe (Vert clair)</li>
                </ul>
            </li>
            <li><strong>Raccourcis:</strong>
                <ul>
                    <li><kbd>C</kbd> - Afficher/Masquer contrÃ´les</li>
                    <li><kbd>I</kbd> - Afficher/Masquer instructions</li>
                    <li><kbd>R</kbd> - RÃ©initialiser diagramme</li>
                    <li><kbd>O</kbd> - Optimiser toutes les connexions</li>
                    <li><kbd>Ã‰chap</kbd> - Effacer sÃ©lection</li>
                </ul>
            </li>
        </ul>
    </div>

    <!-- Logo -->
    <a target="_blank" href="https://www.jointjs.com" class="logo-link">
        <svg version="1.2" id="logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 280" width="150" height="42">
            <path d="m130.71 225.71l-27.28-27.27q0-0.01 0-0.01h76.41v-103.68h27.28c0 0 0 59.4 0 98.19l-32.77 32.77zm330.37-116.97c10.68 10.41 17.29 25.87 17.29 46.13 0 20.26-6.61 35.71-17.29 46.13-10.69 10.41-25.47 15.79-41.91 15.79-16.44 0-31.22-5.38-41.91-15.79-10.68-10.42-17.29-25.87-17.29-46.13 0-20.26 6.61-35.72 17.29-46.13 10.69-10.41 25.47-15.79 41.91-15.79 16.44 0 31.22 5.38 41.91 15.79zm401.41-18.61q-8.23-7.14-22.76-7.15-11.77 0.01-18.3 5.07-6.59 5.11-6.59 14.42 0 6.67 3.47 10.89 3.42 4.18 10.27 7.59 6.77 3.37 20.96 8.6h0.01q14.98 5.85 23.95 10.62 8.92 4.74 15.31 13.26 6.38 8.48 6.38 21.16 0 12.48-6.28 22.05-6.29 9.58-18.03 14.86-11.78 5.29-27.76 5.29-15.99 0-28.09-5.4-12.05-5.39-18.55-15.18-6.49-9.79-6.49-22.71v-7.66h23.37v6.36q-0.01 10.17 8.71 16.92 8.64 6.7 22.95 6.7 13.05-0.01 19.69-5.74 6.69-5.76 6.69-14.84-0.01-6.23-3.69-10.56-3.63-4.29-10.37-7.81-6.67-3.48-20.01-8.7 0 0-0.01 0-14.98-5.64-24.27-10.63-9.23-4.95-15.42-13.46-6.16-8.49-6.16-21.17 0-18.93 13.39-29.9 13.45-11 35.93-10.99 15.77 0 27.86 5.61 12.07 5.6 18.78 15.62 6.7 10.01 6.7 23.13v5.92h-23.37v-4.61q0-10.38-8.27-17.56zm-318.54 18.35h1.52c7.2-9.6 18.63-15.53 34.94-15.53 14.12 0 25.51 4.23 33.38 12.18 7.88 7.95 12.27 19.65 12.27 34.71v74.96h-21.74v-71.71c0-9.84-2.46-17.37-7.24-22.42-4.78-5.03-11.84-7.55-20.88-7.55-10.09 0-18.19 3.05-23.74 9.4-5.05 5.79-7.99 14.26-8.51 25.47v66.53h-21.83v-119.76h21.83zm-194.95-13.73c0 0 0 63.58 0 98.2l-21.85 21.85c-10.29 0-22.53 0-32.81 0l-21.83-21.83q0 0 0 0h54.66v-98.22zm353.46 98.22l-21.83 21.83c0 0-10.89 0-21.8 0l-21.85-21.85v-130.94h21.83v32.74h32.74v21.83h-32.74v76.39h98.31v-130.96h21.83c0 0 0 88.7 0 130.94l-21.85 21.85c-10.29 0-22.53 0-32.81 0 0 0-21.83-21.83-21.83-21.83zm-213.17-98.22h21.83v119.77h-21.83zm-96.8 29.36c-6.6 7.05-10.44 17.44-10.44 30.75 0 13.3 3.84 23.69 10.44 30.74 6.57 7.02 15.86 10.69 26.68 10.69 10.82 0 20.11-3.67 26.68-10.69 6.61-7.05 10.45-17.44 10.45-30.74 0-13.31-3.84-23.7-10.45-30.75-6.57-7.01-15.86-10.69-26.68-10.69-10.82 0-20.11 3.68-26.68 10.69zm-299.99 63.38l-27.28-27.28q0 0 0 0h76.4v-103.69h27.29c0 0 0 59.4 0 98.2l-32.77 32.77zm396.79-125.48h21.82v21.82h-21.82zm-162.11 0h21.82v21.83h-21.82z" />
        </svg>
    </a>

    <!-- Scripts -->
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.17.21/lodash.min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.4.1/backbone-min.js'></script>
    <script src='https://cdnjs.cloudflare.com/ajax/libs/jointjs/3.7.2/joint.min.js'></script>
    <script src="./script.js"></script>
</body>
</html>
